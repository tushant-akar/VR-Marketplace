<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VR Supermarket API - Complete Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem 0;
        }
        
        .container {
            background: white;
            padding: 3rem;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 1400px;
            width: 95%;
            margin: 0 auto;
        }
        
        h1 {
            color: #4a5568;
            margin-bottom: 1rem;
            text-align: center;
            font-size: 2.8rem;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        h2 {
            color: #2d3748;
            margin: 3rem 0 1.5rem 0;
            font-size: 1.8rem;
            border-bottom: 3px solid #667eea;
            padding-bottom: 0.5rem;
        }
        
        h3 {
            color: #4a5568;
            margin: 2rem 0 1rem 0;
            font-size: 1.4rem;
        }
        
        h4 {
            color: #276749;
            margin: 1.5rem 0 0.5rem 0;
            font-size: 1.2rem;
        }
        
        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 2rem;
            font-size: 1.3rem;
        }
        
        .status {
            background: #c6f6d5;
            color: #22543d;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            margin: 2rem 0;
            font-weight: bold;
            border: 2px solid #9ae6b4;
        }
        
        .api-section {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        
        .api-section h2 {
            color: #2b6cb0;
            border-bottom: 2px solid #3182ce;
            margin-top: 0;
        }
        
        .endpoint {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .endpoint:hover {
            border-color: #667eea;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
            transform: translateY(-2px);
        }
        
        .method {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 6px;
            color: white;
            font-weight: bold;
            font-size: 0.85rem;
            margin-right: 1rem;
            min-width: 60px;
            text-align: center;
        }
        
        .method.get { background: #48bb78; }
        .method.post { background: #ed8936; }
        .method.put { background: #4299e1; }
        .method.delete { background: #f56565; }
        
        .auth-required {
            background: #fed7d7;
            color: #c53030;
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
            margin-left: 1rem;
        }
        
        .auth-optional {
            background: #c6f6d5;
            color: #22543d;
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
            margin-left: 1rem;
        }
        
        .endpoint-url {
            background: #1a202c;
            color: #e2e8f0;
            padding: 0.8rem 1.2rem;
            border-radius: 6px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.95rem;
            margin: 1rem 0;
            letter-spacing: 0.5px;
        }
        
        .description {
            color: #4a5568;
            margin: 1rem 0;
            font-size: 1rem;
            line-height: 1.6;
        }
        
        .example-code {
            background: #1a202c;
            color: #e2e8f0;
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1rem 0;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            border: 1px solid #2d3748;
        }
        
        .response-example {
            background: #f0fff4;
            border: 2px solid #9ae6b4;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
        }
        
        .error-example {
            background: #fed7d7;
            border: 2px solid #fc8181;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
        }
        
        .toc {
            background: #edf2f7;
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        
        .toc ul {
            list-style: none;
            padding: 0;
            columns: 2;
            column-gap: 3rem;
        }
        
        .toc li {
            margin: 0.5rem 0;
            break-inside: avoid;
        }
        
        .toc a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
            padding: 0.3rem 0;
            display: block;
        }
        
        .toc a:hover {
            text-decoration: underline;
            color: #553c9a;
        }
        
        .params-section {
            background: #f7fafc;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
        }
        
        .param-item {
            margin: 1rem 0;
            padding: 1rem;
            background: white;
            border-radius: 6px;
            border-left: 4px solid #667eea;
        }
        
        .param-name {
            font-weight: bold;
            color: #2d3748;
            font-family: 'Monaco', 'Menlo', monospace;
        }
        
        .param-type {
            color: #667eea;
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        .param-required {
            color: #e53e3e;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .param-optional {
            color: #38a169;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        th, td {
            border: 1px solid #e2e8f0;
            padding: 1rem;
            text-align: left;
        }
        
        th {
            background: #667eea;
            color: white;
            font-weight: bold;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .feature-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .feature-card h4 {
            color: #2b6cb0;
            margin-bottom: 1rem;
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
        }
        
        .feature-list li {
            padding: 0.3rem 0;
            color: #4a5568;
        }
        
        .feature-list li:before {
            content: '‚úÖ ';
            margin-right: 0.5rem;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 1.5rem;
                margin: 1rem;
                width: calc(100% - 2rem);
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .toc ul {
                columns: 1;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõí VR Supermarket API</h1>
        <p class="subtitle">Complete Backend System for Virtual Reality Shopping Experience</p>
        <p class="subtitle">Built with Supabase, Netlify Functions, Stripe, and ElevenLabs</p>
        
        <div class="status">‚úÖ All API Systems Online - Ready for Production</div>
        
        <!-- Table of Contents -->
        <div class="toc">
            <h3>üìã Complete API Documentation</h3>
            <ul>
                <li><a href="#overview">üèóÔ∏è System Overview</a></li>
                <li><a href="#authentication">üîê Authentication System</a></li>
                <li><a href="#vr-products">üì¶ VR Products API</a></li>
                <li><a href="#vr-shopping">üõí VR Shopping API</a></li>
                <li><a href="#vr-support">üéß VR Customer Support API</a></li>
                <li><a href="#vr-payment">üí≥ VR Payment API</a></li>
                <li><a href="#vr-analytics">üìä VR Analytics API</a></li>
                <li><a href="#auth-endpoints">üîë Auth Endpoints</a></li>
                <li><a href="#otp-system">üì± OTP Management</a></li>
                <li><a href="#response-format">üìÑ Response Format</a></li>
                <li><a href="#error-handling">‚ö†Ô∏è Error Handling</a></li>
                <li><a href="#testing">üß™ Testing & Examples</a></li>
            </ul>
        </div>

        <!-- Overview -->
        <h2 id="overview">üèóÔ∏è System Overview</h2>
        <p>The VR Supermarket API is a comprehensive backend system designed specifically for Virtual Reality shopping experiences. It provides everything needed to create an immersive, interactive VR marketplace with AI-powered customer support, real-time inventory management, and secure payment processing.</p>
        
        <div class="feature-grid">
            <div class="feature-card">
                <h4>üõçÔ∏è VR Shopping Experience</h4>
                <ul class="feature-list">
                    <li>Virtual shopping sessions</li>
                    <li>3D shelf positioning</li>
                    <li>Real-time cart management</li>
                    <li>Product recommendations</li>
                    <li>Sponsored product placement</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>ü§ñ AI Customer Support</h4>
                <ul class="feature-list">
                    <li>ElevenLabs voice integration</li>
                    <li>Conversational product search</li>
                    <li>Multiple support locations</li>
                    <li>Query categorization</li>
                    <li>Satisfaction tracking</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>üí∞ Advanced Payments</h4>
                <ul class="feature-list">
                    <li>Stripe payment integration</li>
                    <li>Cash payment simulation</li>
                    <li>Receipt generation</li>
                    <li>Refund management</li>
                    <li>Order tracking</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>üîí Enterprise Security</h4>
                <ul class="feature-list">
                    <li>JWT with refresh tokens</li>
                    <li>OTP verification (1 min expiry)</li>
                    <li>Row-level security</li>
                    <li>Input validation</li>
                    <li>Activity logging</li>
                </ul>
            </div>
        </div>

        <h3>Base URLs</h3>
        <div class="endpoint-url">Production: https://your-site.netlify.app/api/</div>
        <div class="endpoint-url">Development: http://localhost:8888/.netlify/functions/</div>
        
        <h3>Response Format</h3>
        <div class="example-code">{
  "success": true|false,
  "message": "Human readable message",
  "data": { ... } | null,
  "error": { ... } | null,
  "timestamp": "2025-06-26T12:30:00.000Z"
}</div>

        <!-- Authentication -->
        <div class="api-section" id="authentication">
            <h2>üîê Authentication System</h2>
            <p>Secure JWT-based authentication with refresh token rotation and OTP verification.</p>
            
            <h3>Token Types</h3>
            <table>
                <tr>
                    <th>Token Type</th>
                    <th>Purpose</th>
                    <th>Expiry</th>
                    <th>Usage</th>
                </tr>
                <tr>
                    <td>Access Token</td>
                    <td>API authentication</td>
                    <td>1 hour</td>
                    <td>Authorization: Bearer {token}</td>
                </tr>
                <tr>
                    <td>Refresh Token</td>
                    <td>Renew access tokens</td>
                    <td>7 days</td>
                    <td>Send to /api/auth-refresh</td>
                </tr>
                <tr>
                    <td>OTP Token</td>
                    <td>Registration verification</td>
                    <td>1 minute</td>
                    <td>Email verification code</td>
                </tr>
            </table>
        </div>

        <!-- VR Products API -->
        <div class="api-section" id="vr-products">
            <h2>üì¶ VR Products API</h2>
            <p>Comprehensive product management with VR-specific features like shelf positioning and sponsored product placement.</p>

            <div class="endpoint">
                <span class="method get">GET</span>
                <strong>Get All Products</strong>
                <span class="auth-optional">No Auth Required</span>
                <div class="endpoint-url">/api/vr-products/products</div>
                <div class="description">Retrieve products with advanced filtering, pagination, and VR positioning data. Sponsored products are prioritized in results.</div>
                
                <h4>Query Parameters</h4>
                <div class="params-section">
                    <div class="param-item">
                        <span class="param-name">category_id</span> 
                        <span class="param-type">(string)</span> 
                        <span class="param-optional">OPTIONAL</span>
                        <p>Filter by category UUID (Grocery, Electronics)</p>
                    </div>
                    <div class="param-item">
                        <span class="param-name">subcategory_id</span> 
                        <span class="param-type">(string)</span> 
                        <span class="param-optional">OPTIONAL</span>
                        <p>Filter by subcategory UUID (Fruits, TVs, Mobiles, etc.)</p>
                    </div>
                    <div class="param-item">
                        <span class="param-name">search</span> 
                        <span class="param-type">(string)</span> 
                        <span class="param-optional">OPTIONAL</span>
                        <p>Search in product name, description, and brand</p>
                    </div>
                    <div class="param-item">
                        <span class="param-name">sort_by</span> 
                        <span class="param-type">(string)</span> 
                        <span class="param-optional">OPTIONAL</span>
                        <p>Sort field: name, price, rating, popularity. Default: name</p>
                    </div>
                    <div class="param-item">
                        <span class="param-name">page</span> 
                        <span class="param-type">(number)</span> 
                        <span class="param-optional">OPTIONAL</span>
                        <p>Page number for pagination. Default: 1</p>
                    </div>
                    <div class="param-item">
                        <span class="param-name">limit</span> 
                        <span class="param-type">(number)</span> 
                        <span class="param-optional">OPTIONAL</span>
                        <p>Items per page. Default: 20, Max: 100</p>
                    </div>
                </div>
            </div>

            <div class="endpoint">
                <span class="method get">GET</span>
                <strong>Get Sponsored Products</strong>
                <span class="auth-optional">No Auth Required</span>
                <div class="endpoint-url">/api/vr-products/sponsored</div>
                <div class="description">Get sponsored products for prominent display at front of VR store sections.</div>
            </div>

            <div class="endpoint">
                <span class="method get">GET</span>
                <strong>Get Product Details</strong>
                <span class="auth-optional">No Auth Required</span>
                <div class="endpoint-url">/api/vr-products/products/{productId}</div>
                <div class="description">Get detailed product information including recommendations and shelf position.</div>
            </div>

            <div class="endpoint">
                <span class="method get">GET</span>
                <strong>Get Shelf Products</strong>
                <span class="auth-optional">No Auth Required</span>
                <div class="endpoint-url">/api/vr-products/shelf/{shelfNumber}</div>
                <div class="description">Get products organized by VR shelf compartments (top, middle, bottom).</div>
            </div>

            <div class="endpoint">
                <span class="method get">GET</span>
                <strong>Search Products</strong>
                <span class="auth-optional">No Auth Required</span>
                <div class="endpoint-url">/api/vr-products/search?q={searchTerm}</div>
                <div class="description">Advanced product search with relevance ranking and category filtering.</div>
            </div>

            <div class="endpoint">
                <span class="method get">GET</span>
                <strong>Get Categories</strong>
                <span class="auth-optional">No Auth Required</span>
                <div class="endpoint-url">/api/vr-products/categories</div>
                <div class="description">Get all product categories with subcategories for VR navigation.</div>
            </div>
        </div>

        <!-- VR Shopping API -->
        <div class="api-section" id="vr-shopping">
            <h2>üõí VR Shopping API</h2>
            <p>Manage VR shopping sessions, virtual trolleys, and real-time cart operations.</p>

            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>Create Shopping Session</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-shopping/session</div>
                <div class="description">Create new VR shopping session with empty trolley assignment.</div>
                
                <h4>Request Body</h4>
                <div class="example-code">{
  "vr_data": {
    "headset": "Meta Quest 3",
    "location": "entrance",
    "user_height": 175,
    "preferred_language": "en"
  }
}</div>
            </div>

            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>Add to Cart</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-shopping/cart/add</div>
                <div class="description">Add product to VR trolley with stock validation.</div>
                
                <h4>Request Body</h4>
                <div class="example-code">{
  "session_id": "uuid-here",
  "product_id": "uuid-here",
  "quantity": 2
}</div>
            </div>

            <div class="endpoint">
                <span class="method get">GET</span>
                <strong>Get Cart Contents</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-shopping/cart/{sessionId}</div>
                <div class="description">Get current trolley contents with totals and product details.</div>
            </div>

            <div class="endpoint">
                <span class="method put">PUT</span>
                <strong>Update Cart Quantity</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-shopping/cart/quantity</div>
                <div class="description">Update product quantity in trolley.</div>
            </div>

            <div class="endpoint">
                <span class="method delete">DELETE</span>
                <strong>Remove from Cart</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-shopping/cart/{sessionId}/{productId}</div>
                <div class="description">Remove specific product from trolley.</div>
            </div>
        </div>

        <!-- VR Customer Support API -->
        <div class="api-section" id="vr-support">
            <h2>üéß VR Customer Support API</h2>
            <p>AI-powered customer support with ElevenLabs voice integration for natural VR interactions.</p>

            <div class="endpoint">
                <span class="method get">GET</span>
                <strong>Get Support Locations</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-support/locations</div>
                <div class="description">Get all AI support agent locations in VR space with specializations.</div>
            </div>

            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>Start AI Conversation</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-support/conversation/start</div>
                <div class="description">Begin AI-powered support conversation with voice response.</div>
                
                <h4>Request Body</h4>
                <div class="example-code">{
  "session_id": "uuid-here",
  "support_location_id": "uuid-here",
  "initial_query": "I need a 55-inch smart TV under $700"
}</div>
                
                <h4>AI Response Features</h4>
                <ul class="feature-list">
                    <li>Product recommendations based on query</li>
                    <li>Voice audio response via ElevenLabs</li>
                    <li>Follow-up questions for refinement</li>
                    <li>Virtual product booklet generation</li>
                </ul>
            </div>

            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>Send Message to AI</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-support/conversation/message</div>
                <div class="description">Continue conversation with AI support agent.</div>
            </div>

            <div class="endpoint">
                <span class="method put">PUT</span>
                <strong>End Conversation</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-support/conversation/end</div>
                <div class="description">End support conversation with satisfaction rating.</div>
            </div>
        </div>

        <!-- VR Payment API -->
        <div class="api-section" id="vr-payment">
            <h2>üí≥ VR Payment API</h2>
            <p>Complete payment processing with cashier interaction, Stripe integration, and receipt generation.</p>

            <div class="endpoint">
                <span class="method get">GET</span>
                <strong>Initialize Checkout</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-payment/checkout/{sessionId}</div>
                <div class="description">Initialize checkout process with stock validation and tax calculation.</div>
            </div>

            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>Create Order</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-payment/order</div>
                <div class="description">Create order record for payment processing.</div>
                
                <h4>Request Body</h4>
                <div class="example-code">{
  "session_id": "uuid-here",
  "payment_method": "cash" // or "stripe"
}</div>
            </div>

            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>Process Cash Payment</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-payment/payment/cash</div>
                <div class="description">Process cash payment with virtual cashier interaction.</div>
                
                <h4>Request Body</h4>
                <div class="example-code">{
  "order_id": "uuid-here",
  "cash_received": 75.50
}</div>
            </div>

            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>Create Stripe Payment</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-payment/payment/stripe/intent</div>
                <div class="description">Create Stripe payment intent for card payment.</div>
            </div>

            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>Confirm Stripe Payment</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-payment/payment/stripe/confirm</div>
                <div class="description">Confirm successful Stripe payment and complete order.</div>
            </div>

            <div class="endpoint">
                <span class="method get">GET</span>
                <strong>Generate Receipt</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-payment/receipt/{orderId}</div>
                <div class="description">Generate detailed receipt for completed order.</div>
            </div>
        </div>

        <!-- Auth Endpoints -->
        <div class="api-section" id="auth-endpoints">
            <h2>üîë Authentication Endpoints</h2>
            <p>Complete user authentication system with OTP verification and secure session management.</p>

            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>User Registration</strong>
                <span class="auth-optional">No Auth Required</span>
                <div class="endpoint-url">/api/auth-register</div>
                <div class="description">Register new user with OTP verification via email.</div>
                
                <h4>Request Body</h4>
                <div class="example-code">{
  "email": "user@example.com",
  "password": "SecurePass123!",
  "name": "John Doe",
  "phoneNumber": "+1234567890"
}</div>
            </div>

            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>Verify Registration OTP</strong>
                <span class="auth-optional">No Auth Required</span>
                <div class="endpoint-url">/api/auth-verify-otp</div>
                <div class="description">Verify OTP code to complete registration (1 minute expiry).</div>
                
                <h4>Request Body</h4>
                <div class="example-code">{
  "email": "user@example.com",
  "otp": "123456"
}</div>
            </div>

            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>Resend OTP</strong>
                <span class="auth-optional">No Auth Required</span>
                <div class="endpoint-url">/api/auth-resend-otp</div>
                <div class="description">Resend OTP code with 1-minute expiry and proper rate limiting.</div>
                
                <h4>Request Body</h4>
                <div class="example-code">{
  "email": "user@example.com"
}</div>
                
                <h4>Rate Limiting</h4>
                <ul class="feature-list">
                    <li>Maximum 3 resend attempts per email per hour</li>
                    <li>30-second cooldown between resend requests</li>
                    <li>Automatic cleanup of expired OTPs</li>
                    <li>Progressive delay for multiple attempts</li>
                </ul>
            </div>

            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>User Login</strong>
                <span class="auth-optional">No Auth Required</span>
                <div class="endpoint-url">/api/auth-login</div>
                <div class="description">Authenticate user and receive access/refresh tokens.</div>
                
                <h4>Request Body</h4>
                <div class="example-code">{
  "email": "user@example.com",
  "password": "SecurePass123!",
  "rememberMe": true
}</div>
            </div>

            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>Refresh Token</strong>
                <span class="auth-optional">No Auth Required</span>
                <div class="endpoint-url">/api/auth-refresh</div>
                <div class="description">Get new access token using refresh token.</div>
            </div>

            <div class="endpoint">
                <span class="method get">GET</span>
                <strong>Get Profile</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/auth-profile</div>
                <div class="description">Get authenticated user's profile information.</div>
            </div>

            <div class="endpoint">
                <span class="method put">PUT</span>
                <strong>Update Profile</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/auth-profile</div>
                <div class="description">Update user profile information.</div>
            </div>

            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>Change Password</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/auth-change-password</div>
                <div class="description">Change user password with current password verification.</div>
            </div>

            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>Logout</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/auth-logout</div>
                <div class="description">Logout user and invalidate all tokens.</div>
            </div>
        </div>

        <!-- OTP System -->
        <div class="api-section" id="otp-system">
            <h2>üì± OTP Management System</h2>
            <p>Advanced OTP verification system with 1-minute expiry, rate limiting, and secure token management.</p>
            
            <h3>OTP Features</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üîí Security</h4>
                    <ul class="feature-list">
                        <li>6-digit secure random codes</li>
                        <li>bcrypt hashing of OTP codes</li>
                        <li>1-minute expiry time</li>
                        <li>Maximum 5 verification attempts</li>
                        <li>Automatic cleanup of expired OTPs</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h4>‚è±Ô∏è Rate Limiting</h4>
                    <ul class="feature-list">
                        <li>30-second cooldown between resends</li>
                        <li>3 resend attempts per hour per email</li>
                        <li>Progressive delay for multiple attempts</li>
                        <li>IP-based rate limiting protection</li>
                        <li>Automatic lockout for abuse</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h4>üìß Delivery</h4>
                    <ul class="feature-list">
                        <li>SendGrid email integration</li>
                        <li>Professional email templates</li>
                        <li>Delivery status tracking</li>
                        <li>Fallback delivery methods</li>
                        <li>Multi-language support</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h4>üîÑ Management</h4>
                    <ul class="feature-list">
                        <li>Real-time expiry tracking</li>
                        <li>Automatic database cleanup</li>
                        <li>Comprehensive logging</li>
                        <li>Statistics and monitoring</li>
                        <li>Admin override capabilities</li>
                    </ul>
                </div>
            </div>
            
            <h3>OTP Flow Example</h3>
            <div class="example-code">// 1. Register user (triggers OTP)
const registerResponse = await fetch('/api/auth-register', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    email: 'user@example.com',
    password: 'SecurePass123!',
    name: 'John Doe'
  })
});

// 2. User receives OTP via email (expires in 1 minute)
// 3. Verify OTP
const verifyResponse = await fetch('/api/auth-verify-otp', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    email: 'user@example.com',
    otp: '123456'
  })
});

// 4. If OTP expired, resend (with rate limiting)
const resendResponse = await fetch('/api/auth-resend-otp', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    email: 'user@example.com'
  })
});</div>
        </div>

        <!-- VR Analytics API -->
        <div class="api-section" id="vr-analytics">
            <h2>üìä VR Analytics API</h2>
            <p>Comprehensive tracking and analytics for VR user behavior and business intelligence.</p>

            <div class="endpoint">
                <span class="method get">GET</span>
                <strong>User Activity Logs</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-analytics/user/activity</div>
                <div class="description">Get detailed VR activity logs for the authenticated user.</div>
            </div>

            <div class="endpoint">
                <span class="method get">GET</span>
                <strong>Shopping Sessions</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-analytics/user/sessions</div>
                <div class="description">Get user's VR shopping session history and statistics.</div>
            </div>

            <div class="endpoint">
                <span class="method post">POST</span>
                <strong>Track Custom Activity</strong>
                <span class="auth-required">Auth Required</span>
                <div class="endpoint-url">/api/vr-analytics/track</div>
                <div class="description">Track custom VR interactions and user behavior.</div>
                
                <h4>Request Body</h4>
                <div class="example-code">{
  "session_id": "uuid-here",
  "activity_type": "product_interaction",
  "activity_data": {
    "product_id": "uuid-here",
    "interaction_type": "picked_up",
    "duration_seconds": 15
  },
  "location_data": {
    "x": 45.2,
    "y": 0,
    "z": 23.8,
    "rotation": "0,180,0"
  }
}</div>
            </div>
        </div>

        <!-- Response Format -->
        <div class="api-section" id="response-format">
            <h2>üìÑ Response Format</h2>
            <p>All API endpoints return consistent JSON responses with comprehensive error information.</p>
            
            <h3>Success Response</h3>
            <div class="response-example">
                <div class="example-code">{
  "success": true,
  "message": "Operation completed successfully",
  "data": {
    "user": {
      "id": "uuid-here",
      "email": "user@example.com",
      "name": "John Doe"
    },
    "tokens": {
      "accessToken": "jwt-token-here",
      "refreshToken": "refresh-token-here"
    }
  },
  "timestamp": "2025-06-26T12:30:00.000Z"
}</div>
            </div>
            
            <h3>Error Response</h3>
            <div class="error-example">
                <div class="example-code">{
  "success": false,
  "message": "Validation failed",
  "error": {
    "code": "VALIDATION_ERROR",
    "validationErrors": [
      "Email is required",
      "Password must be at least 8 characters"
    ],
    "field": "email"
  },
  "timestamp": "2025-06-26T12:30:00.000Z"
}</div>
            </div>
        </div>

        <!-- Error Handling -->
        <div class="api-section" id="error-handling">
            <h2>‚ö†Ô∏è Error Handling</h2>
            
            <h3>HTTP Status Codes</h3>
            <table>
                <tr>
                    <th>Status Code</th>
                    <th>Meaning</th>
                    <th>Description</th>
                    <th>Example</th>
                </tr>
                <tr>
                    <td>200</td>
                    <td>OK</td>
                    <td>Request successful</td>
                    <td>Data retrieved successfully</td>
                </tr>
                <tr>
                    <td>400</td>
                    <td>Bad Request</td>
                    <td>Validation errors</td>
                    <td>Invalid email format</td>
                </tr>
                <tr>
                    <td>401</td>
                    <td>Unauthorized</td>
                    <td>Authentication required</td>
                    <td>Invalid or expired token</td>
                </tr>
                <tr>
                    <td>403</td>
                    <td>Forbidden</td>
                    <td>Insufficient permissions</td>
                    <td>Cannot access other user's data</td>
                </tr>
                <tr>
                    <td>404</td>
                    <td>Not Found</td>
                    <td>Resource not found</td>
                    <td>Product or order not found</td>
                </tr>
                <tr>
                    <td>409</td>
                    <td>Conflict</td>
                    <td>Resource conflicts</td>
                    <td>Email already registered</td>
                </tr>
                <tr>
                    <td>429</td>
                    <td>Too Many Requests</td>
                    <td>Rate limit exceeded</td>
                    <td>Too many OTP requests</td>
                </tr>
                <tr>
                    <td>500</td>
                    <td>Internal Server Error</td>
                    <td>Server-side error</td>
                    <td>Database connection failed</td>
                </tr>
            </table>
        </div>

        <!-- Testing -->
        <div class="api-section" id="testing">
            <h2>üß™ Testing & Examples</h2>
            
            <h3>Complete VR Shopping Flow</h3>
            <div class="example-code">// 1. Register and verify user
const registerResponse = await fetch('/api/auth-register', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    email: 'vr-user@example.com',
    password: 'VRPass123!',
    name: 'VR Shopper'
  })
});

// 2. Verify OTP (check email for code)
await fetch('/api/auth-verify-otp', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    email: 'vr-user@example.com',
    otp: '123456' // From email
  })
});

// 3. Login to get tokens
const loginResponse = await fetch('/api/auth-login', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    email: 'vr-user@example.com',
    password: 'VRPass123!'
  })
});

const { data: { tokens } } = await loginResponse.json();

// 4. Start VR shopping session
const sessionResponse = await fetch('/api/vr-shopping/session', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${tokens.accessToken}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    vr_data: {
      headset: 'Meta Quest 3',
      location: 'entrance'
    }
  })
});

const { data: { session } } = await sessionResponse.json();

// 5. Browse sponsored products
const sponsoredResponse = await fetch('/api/vr-products/sponsored');
const sponsoredProducts = await sponsoredResponse.json();

// 6. Add product to cart
await fetch('/api/vr-shopping/cart/add', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${tokens.accessToken}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    session_id: session.id,
    product_id: sponsoredProducts.data[0].id,
    quantity: 1
  })
});

// 7. Get AI support
const supportResponse = await fetch('/api/vr-support/conversation/start', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${tokens.accessToken}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    session_id: session.id,
    support_location_id: 'electronics-support',
    initial_query: 'I need a good TV for gaming'
  })
});

// 8. Checkout and payment
const checkoutResponse = await fetch(`/api/vr-payment/checkout/${session.id}`, {
  headers: { 'Authorization': `Bearer ${tokens.accessToken}` }
});

const orderResponse = await fetch('/api/vr-payment/order', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${tokens.accessToken}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    session_id: session.id,
    payment_method: 'stripe'
  })
});

// 9. Complete payment with Stripe
// (Stripe integration steps here)

// 10. Get receipt
const receipt = await fetch(`/api/vr-payment/receipt/${orderId}`, {
  headers: { 'Authorization': `Bearer ${tokens.accessToken}` }
});</div>

            <h3>Test with cURL</h3>
            <div class="example-code"># Register user
curl -X POST https://your-site.netlify.app/api/auth-register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "TestPass123!",
    "name": "Test User"
  }'

# Get sponsored products
curl -X GET https://your-site.netlify.app/api/vr-products/sponsored

# Create shopping session (with auth token)
curl -X POST https://your-site.netlify.app/api/vr-shopping/session \
  -H "Authorization: Bearer YOUR_TOKEN_HERE" \
  -H "Content-Type: application/json" \
  -d '{
    "vr_data": {
      "headset": "Meta Quest 3",
      "location": "entrance"
    }
  }'</div>
        </div>

        <div class="api-section">
            <h2>üöÄ Ready for Production</h2>
            <p>This VR Supermarket API is fully production-ready with comprehensive security, error handling, and scalability features. Perfect for hackathon deployment and real-world VR commerce applications.</p>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>üèÜ Hackathon Ready</h4>
                    <ul class="feature-list">
                        <li>Complete MVP functionality</li>
                        <li>No mocks or placeholders</li>
                        <li>Production-grade security</li>
                        <li>Comprehensive documentation</li>
                        <li>Real payment processing</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h4>üîß Developer Friendly</h4>
                    <ul class="feature-list">
                        <li>Consistent API patterns</li>
                        <li>Detailed error messages</li>
                        <li>Comprehensive testing</li>
                        <li>Clear documentation</li>
                        <li>Example implementations</li>
                    </ul>
                </div>
            </div>
        </div>

        <div style="text-align: center; margin-top: 3rem; padding: 2rem; background: linear-gradient(45deg, #667eea, #764ba2); border-radius: 12px; color: white;">
            <h3>üåü Built for the Future of VR Commerce</h3>
            <p>Complete backend system ready for the world's largest hackathon</p>
            <p><strong>Authentication ‚Ä¢ VR Shopping ‚Ä¢ AI Support ‚Ä¢ Payments ‚Ä¢ Analytics</strong></p>
        </div>
    </div>
</body>
</html>